---
apiVersion: cluster.x-k8s.io/v1beta1
kind: Cluster
metadata:
  name: ${CLUSTER_NAME}
  labels:
    cni: "calico-dual-stack"
spec:
  clusterNetwork:
    pods:
      # this is a part of the virtual network IP range.
      # See https://docs.projectcalico.org/reference/public-cloud/azure
      cidrBlocks:
      - "50.244.0.0/16"
      - "2001:1234:5678:9a40::/58"
    services:
      cidrBlocks:
      - "50.0.0.0/16"
      - "fd00::/108"
---
apiVersion: infrastructure.cluster.x-k8s.io/v1beta1
kind: AzureCluster
metadata:
  name: ${CLUSTER_NAME}
spec:
  networkSpec:
    apiServerLB:
      # We pre-create this public IP and the DNS name to use it in the
      # worker node's /etc/hosts.
      frontendIPs:
        - name: ${CLUSTER_NAME}-api-lb
          publicIP:
            name: ${CLUSTER_NAME}-api-lb
            dnsName: ${CLUSTER_NAME}-${APISERVER_LB_DNS_SUFFIX}.${AZURE_LOCATION}.cloudapp.azure.com
        - name: ${CLUSTER_NAME}-internal-lb-private-ip
          privateIP: 50.0.0.100
    vnet:
      cidrBlocks:
        - "50.0.0.0/8"
        - "2001:1234:5678:9a00::/56"
    subnets:
      - name: control-plane-subnet
        role: control-plane
        cidrBlocks:
          - "50.0.0.0/16"
          - "2001:1234:5678:9abc::/64"
      - name: node-subnet
        role: node
        cidrBlocks:
          - "50.1.0.0/16"
          - "2001:1234:5678:9abd::/64"
